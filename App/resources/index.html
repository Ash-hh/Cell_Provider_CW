<!DOCTYPE html>
<html>
    <head>
        <title>
            register
        </title>
        <style>
            header{
                border:1px solid black
            }
        </style>
        <script>
            function onloadTariffs(){

                let refconfig = 'http://localhost:5000';

                fetch('http://localhost:5000/api/all/AllTariffs')
                .then(response=>{
                    console.log(response.headers.get('Content-Type'));
                    return response.json();
                })
                .then((data)=>{                    
                    data.forEach(element => {
                        Tariffs.innerHTML+=`
                        <tr> 
                            <td>${element.Description}</td> 
                            <td>${element.Call_Cost_perm}</td> 
                            <td> <a href="${refconfig}/subtariff?id=${element.Tariff_Id}">Get Tariff</a> </td>
                        </tr>`;
                    });
                   
                })
            }

            function GetUser(){
                fetch('http://localhost:5000/api/findbyid/FindUser/cookie')
                .then(response=>{
                    if(response.ok){
                        return response.json();
                    }    
                    else{
                        return 0;
                    }
                })
                .then((data)=>{   
                                 
                    if(!data){
                      header.innerHTML+=`
                      <a href='http://localhost:5000/login'>Log In</a> 
                      <a href='http://localhost:5000/register'>register</a>`
                    } else {
                       
                        header.innerHTML+=`
                      <a href='http://localhost:5000/profile/${data.Login}'>profile</a>
                      <a href='http://localhost:5000/logout'>log out</a>`
                      if(data.User_Type == 1){
                        header.innerHTML+=`
                        <a href='http://localhost:5000/Admin/main'>Admin</a>`
                      }
                      
                    }
                })
            }

            function load(){
                onloadTariffs();
                GetUser();
            }
        </script>
    </head>
    <body onload="load()">      
       <header id="header">
          
       </header>
       <div>
           <table id="Tariffs">
               <tr>
                   <td>Description</td>
                   <td>Call Cost</td>
               </tr>
           </table>
       </div>
    </body>
    
</html>